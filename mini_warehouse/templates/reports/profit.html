{% extends "base.html" %}

{% block content %}
    <div class="report-container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã -->
        <div class="page-header">
            <h1><i class="fas fa-chart-pie"></i> –û—Ç—á—ë—Ç –ø–æ –ø—Ä–∏–±—ã–ª–∏</h1>
            <div class="report-period">
                <i class="fas fa-calendar-alt"></i>
                –ü–µ—Ä–∏–æ–¥: {{ form.date_from.value|default:"‚Äî" }} - {{ form.date_to.value|default:"‚Äî" }}
            </div>
        </div>

        <p class="page-subtitle">–ê–Ω–∞–ª–∏–∑ –≤—ã—Ä—É—á–∫–∏, —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∏ –ø—Ä–∏–±—ã–ª–∏ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥</p>

        <!-- –§–∏–ª—å—Ç—Ä—ã –æ—Ç—á—ë—Ç–∞ -->
        <form method="get" class="sales-filters">
            <div class="filter-group {% if form.date_from.errors %}has-error{% endif %}">
                <label class="filter-label">
                    <i class="fas fa-calendar"></i> –î–∞—Ç–∞ —Å
                </label>
                {{ form.date_from }}
                {{ form.date_from.errors }}
            </div>

            <div class="filter-group {% if form.date_to.errors %}has-error{% endif %}">
                <label class="filter-label">
                    <i class="fas fa-calendar"></i> –î–∞—Ç–∞ –ø–æ
                </label>
                {{ form.date_to }}
                {{ form.date_to.errors }}
            </div>

            <div class="filter-actions">
                <button class="btn btn-primary" type="submit">
                    <i class="fas fa-chart-line"></i> –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á—ë—Ç
                </button>
                <a class="btn btn-secondary" href="{% url 'reports:profit' %}">
                    <i class="fas fa-redo"></i> –°–±—Ä–æ—Å–∏—Ç—å
                </a>
            </div>
        </form>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç—á—ë—Ç–∞ -->
        <div class="report-stats">
            <div class="report-stat-card">
                <div class="stat-icon">üí∞</div>
                <div class="stat-label">–í—ã—Ä—É—á–∫–∞</div>
                <div class="stat-value revenue">‚ÇΩ {{ metrics.revenue|floatformat:2 }}</div>
                <div class="stat-change positive">Œ£(quantity √ó sale_price)</div>
            </div>

            <div class="report-stat-card">
                <div class="stat-icon">üìä</div>
                <div class="stat-label">–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å</div>
                <div class="stat-value cost">‚ÇΩ {{ metrics.cost|floatformat:2 }}</div>
                <div class="stat-change negative">Œ£(quantity √ó purchase_price)</div>
            </div>

            <div class="report-stat-card">
                <div class="stat-icon">üìà</div>
                <div class="stat-label">–ü—Ä–∏–±—ã–ª—å</div>
                <div class="stat-value profit">‚ÇΩ {{ metrics.profit|floatformat:2 }}</div>
                <div class="stat-change positive">Revenue - Cost</div>
            </div>
        </div>

        <!-- –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="card">
            <div class="report-table-header">
                <h3><i class="fas fa-list-alt"></i> –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç—á—ë—Ç–∞</h3>
                <span class="badge">–ü—Ä–æ–¥–∞–∂: {{ metrics.sales_count }}</span>
            </div>

            <div class="table-wrapper">
                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th><i class="fas fa-cube"></i> –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å</th>
                                <th><i class="fas fa-hashtag"></i> –ó–Ω–∞—á–µ–Ω–∏–µ</th>
                                <th><i class="fas fa-percentage"></i> –î–æ–ª—è</th>
                                <th><i class="fas fa-chart-bar"></i> –ì—Ä–∞—Ñ–∏–∫</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <div class="product-info">
                                        <div class="product-icon">üí∞</div>
                                        <div>
                                            <div class="product-name">–í—ã—Ä—É—á–∫–∞ (Revenue)</div>
                                            <div class="product-sku">Œ£(quantity √ó sale_price)</div>
                                        </div>
                                    </div>
                                </td>
                                <td><span class="price">‚ÇΩ {{ metrics.revenue|floatformat:2 }}</span></td>
                                <td><span class="status status-in-stock">100%</span></td>
                                <td>
                                    <div style="width: 100%; height: 8px; background: rgba(255, 255, 255, 0.1); border-radius: 4px; overflow: hidden;">
                                        <div style="width: 100%; height: 100%; background: linear-gradient(90deg, var(--newyear-gold), var(--newyear-red));"></div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="product-info">
                                        <div class="product-icon">üìä</div>
                                        <div>
                                            <div class="product-name">–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å (Cost)</div>
                                            <div class="product-sku">Œ£(quantity √ó purchase_price)</div>
                                        </div>
                                    </div>
                                </td>
                                <td><span class="price">‚ÇΩ {{ metrics.cost|floatformat:2 }}</span></td>
                                <td><span class="status status-low">-</span></td>
                                <td>
                                    <div style="width: 100%; height: 8px; background: rgba(255, 255, 255, 0.1); border-radius: 4px; overflow: hidden;">
                                        <div style="width: 75.7%; height: 100%; background: var(--newyear-blue);"></div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="product-info">
                                        <div class="product-icon">üìà</div>
                                        <div>
                                            <div class="product-name">–ü—Ä–∏–±—ã–ª—å (Profit)</div>
                                            <div class="product-sku">Revenue - Cost</div>
                                        </div>
                                    </div>
                                </td>
                                <td><span class="price">‚ÇΩ {{ metrics.profit|floatformat:2 }}</span></td>
                                <td><span class="status status-in-stock">-</span></td>
                                <td>
                                    <div style="width: 100%; height: 8px; background: rgba(255, 255, 255, 0.1); border-radius: 4px; overflow: hidden;">
                                        <div style="width: 24.3%; height: 100%; background: var(--newyear-green);"></div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
