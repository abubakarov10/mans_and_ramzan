{% load static %}
<!DOCTYPE html>
<html lang="ru" data-theme="newyear">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÑ SuRam - –û—Ç—á—ë—Ç—ã</title>

    <!-- Icons -->
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Mountains+of+Christmas:wght@700&family=Inter:wght@300;400;500;600;700&display=swap"
          rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/theme.css' %}">
</head>

<body data-theme="newyear">

<!-- Background -->
<div class="newyear-bg"></div>
<div class="snowflakes" id="snowflakes"></div>

<!-- NAVBAR -->
<nav class="navbar">
    <div class="container nav-container">
        <a href="{% url 'products:list' %}" class="logo">
            <div class="logo-icon">üéÑ</div>
            <div class="logo-text">SuRam <span class="year">2025</span></div>
        </a>

        <div class="desktop-menu">
            <ul class="nav-list">
                <li><a href="{% url 'products:list' %}" class="nav-link"><i class="fas fa-home"></i> –ì–ª–∞–≤–Ω–∞—è</a></li>
                <li><a href="{% url 'products:list' %}" class="nav-link"><i class="fas fa-boxes"></i> –¢–æ–≤–∞—Ä—ã</a></li>
                <li><a href="{% url 'sales:list' %}" class="nav-link"><i class="fas fa-shopping-cart"></i> –ü—Ä–æ–¥–∞–∂–∏</a></li>
                <li><a href="{% url 'reports:profit' %}" class="nav-link active"><i class="fas fa-chart-pie"></i> –û—Ç—á—ë—Ç—ã</a></li>
                <li>
                    <a href="{% url 'sales:create' %}" class="btn btn-danger">
                        <i class="fas fa-bolt"></i> –ù–æ–≤–∞—è –ø—Ä–æ–¥–∞–∂–∞
                    </a>
                </li>
            </ul>
        </div>

        <div class="mobile-menu">
            <button class="theme-toggle-mobile" id="themeToggleMobile">
                <i class="fas fa-palette"></i>
            </button>
            <button class="menu-toggle" id="menuToggle">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </div>
</nav>

<!-- MAIN -->
<main class="container">
    <div class="report-container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã -->
        <div class="page-header">
            <h1><i class="fas fa-chart-pie"></i> –û—Ç—á—ë—Ç –ø–æ –ø—Ä–∏–±—ã–ª–∏</h1>
            <div class="report-period">
                <i class="fas fa-calendar-alt"></i>
                –ü–µ—Ä–∏–æ–¥: {{ form.date_from.value|default:"‚Äî" }} - {{ form.date_to.value|default:"‚Äî" }}
            </div>
        </div>

        <p class="page-subtitle">–ê–Ω–∞–ª–∏–∑ –≤—ã—Ä—É—á–∫–∏, —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∏ –ø—Ä–∏–±—ã–ª–∏ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥</p>

        <!-- –§–∏–ª—å—Ç—Ä—ã –æ—Ç—á—ë—Ç–∞ -->
        <form method="get" class="sales-filters">
            <div class="filter-group">
                <label class="filter-label">
                    <i class="fas fa-calendar"></i> –î–∞—Ç–∞ —Å
                </label>
                {{ form.date_from }}
            </div>

            <div class="filter-group">
                <label class="filter-label">
                    <i class="fas fa-calendar"></i> –î–∞—Ç–∞ –ø–æ
                </label>
                {{ form.date_to }}
            </div>

            <div class="filter-actions">
                <button class="btn btn-primary" type="submit">
                    <i class="fas fa-chart-line"></i> –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á—ë—Ç
                </button>
                <a class="btn btn-secondary" href="{% url 'reports:profit' %}">
                    <i class="fas fa-redo"></i> –°–±—Ä–æ—Å–∏—Ç—å
                </a>
            </div>
        </form>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç—á—ë—Ç–∞ -->
        <div class="report-stats">
            <div class="report-stat-card">
                <div class="stat-icon">üí∞</div>
                <div class="stat-label">–í—ã—Ä—É—á–∫–∞</div>
                <div class="stat-value revenue">‚ÇΩ {{ metrics.revenue|floatformat:2 }}</div>
                <div class="stat-change positive">Œ£(quantity √ó sale_price)</div>
            </div>

            <div class="report-stat-card">
                <div class="stat-icon">üìä</div>
                <div class="stat-label">–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å</div>
                <div class="stat-value cost">‚ÇΩ {{ metrics.cost|floatformat:2 }}</div>
                <div class="stat-change negative">Œ£(quantity √ó purchase_price)</div>
            </div>

            <div class="report-stat-card">
                <div class="stat-icon">üìà</div>
                <div class="stat-label">–ü—Ä–∏–±—ã–ª—å</div>
                <div class="stat-value profit">‚ÇΩ {{ metrics.profit|floatformat:2 }}</div>
                <div class="stat-change positive">Revenue - Cost</div>
            </div>
        </div>

        <!-- –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="card">
            <div class="report-table-header">
                <h3><i class="fas fa-list-alt"></i> –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç—á—ë—Ç–∞</h3>
                <span class="badge">–ü—Ä–æ–¥–∞–∂: {{ metrics.sales_count }}</span>
            </div>

            <div class="table-wrapper">
                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th><i class="fas fa-cube"></i> –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å</th>
                                <th><i class="fas fa-hashtag"></i> –ó–Ω–∞—á–µ–Ω–∏–µ</th>
                                <th><i class="fas fa-percentage"></i> –î–æ–ª—è</th>
                                <th><i class="fas fa-chart-bar"></i> –ì—Ä–∞—Ñ–∏–∫</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <div class="product-info">
                                        <div class="product-icon">üí∞</div>
                                        <div>
                                            <div class="product-name">–í—ã—Ä—É—á–∫–∞ (Revenue)</div>
                                            <div class="product-sku">Œ£(quantity √ó sale_price)</div>
                                        </div>
                                    </div>
                                </td>
                                <td><span class="price">‚ÇΩ {{ metrics.revenue|floatformat:2 }}</span></td>
                                <td><span class="status status-in-stock">100%</span></td>
                                <td>
                                    <div style="width: 100%; height: 8px; background: rgba(255, 255, 255, 0.1); border-radius: 4px; overflow: hidden;">
                                        <div style="width: 100%; height: 100%; background: linear-gradient(90deg, var(--newyear-gold), var(--newyear-red));"></div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="product-info">
                                        <div class="product-icon">üìä</div>
                                        <div>
                                            <div class="product-name">–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å (Cost)</div>
                                            <div class="product-sku">Œ£(quantity √ó purchase_price)</div>
                                        </div>
                                    </div>
                                </td>
                                <td><span class="price">‚ÇΩ {{ metrics.cost|floatformat:2 }}</span></td>
                                <td><span class="status status-low">-</span></td>
                                <td>
                                    <div style="width: 100%; height: 8px; background: rgba(255, 255, 255, 0.1); border-radius: 4px; overflow: hidden;">
                                        <div style="width: 75.7%; height: 100%; background: var(--newyear-blue);"></div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="product-info">
                                        <div class="product-icon">üìà</div>
                                        <div>
                                            <div class="product-name">–ü—Ä–∏–±—ã–ª—å (Profit)</div>
                                            <div class="product-sku">Revenue - Cost</div>
                                        </div>
                                    </div>
                                </td>
                                <td><span class="price">‚ÇΩ {{ metrics.profit|floatformat:2 }}</span></td>
                                <td><span class="status status-in-stock">-</span></td>
                                <td>
                                    <div style="width: 100%; height: 8px; background: rgba(255, 255, 255, 0.1); border-radius: 4px; overflow: hidden;">
                                        <div style="width: 24.3%; height: 100%; background: var(--newyear-green);"></div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="product-info">
                                        <div class="product-icon">üì¶</div>
                                        <div>
                                            <div class="product-name">–ü—Ä–æ–¥–∞–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤</div>
                                            <div class="product-sku">–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ</div>
                                        </div>
                                    </div>
                                </td>
                                <td><span class="price">{{ metrics.items_sold }} —à—Ç.</span></td>
                                <td><span class="status status-in-stock">-</span></td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="product-info">
                                        <div class="product-icon">üõí</div>
                                        <div>
                                            <div class="product-name">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–∂</div>
                                            <div class="product-sku">–í—Å–µ–≥–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</div>
                                        </div>
                                    </div>
                                </td>
                                <td><span class="price">{{ metrics.sales_count }} –ø—Ä–æ–¥–∞–∂</span></td>
                                <td><span class="status status-in-stock">-</span></td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="product-info">
                                        <div class="product-icon">üíµ</div>
                                        <div>
                                            <div class="product-name">–°—Ä–µ–¥–Ω–∏–π —á–µ–∫</div>
                                            <div class="product-sku">Revenue √∑ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–∂</div>
                                        </div>
                                    </div>
                                </td>
                                <td><span class="price">‚ÇΩ {{ average_ticket|floatformat:2 }}</span></td>
                                <td><span class="status status-in-stock">-</span></td>
                                <td>-</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- –ü–æ—è—Å–Ω–µ–Ω–∏—è -->
        <div class="card" style="margin-top: 25px; background: rgba(255, 217, 61, 0.1); border-color: rgba(255, 217, 61, 0.3);">
            <h3><i class="fas fa-lightbulb"></i> –ü–æ—è—Å–Ω–µ–Ω–∏—è –∫ –æ—Ç—á—ë—Ç—É</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 15px;">
                <div>
                    <h4 style="color: var(--newyear-gold); margin-bottom: 8px; font-size: 0.95rem;">üí∞ –í—ã—Ä—É—á–∫–∞ (Revenue)</h4>
                    <p style="color: var(--light); font-size: 0.85rem;">
                        –°—É–º–º–∞ –≤—Å–µ—Ö –ø—Ä–æ–¥–∞–∂ –ø–æ —Ü–µ–Ω–∞–º –ø—Ä–æ–¥–∞–∂–∏. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ √ó —Ü–µ–Ω–∞_–ø—Ä–æ–¥–∞–∂–∏.
                    </p>
                </div>
                <div>
                    <h4 style="color: var(--newyear-blue); margin-bottom: 8px; font-size: 0.95rem;">üìä –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å (Cost)</h4>
                    <p style="color: var(--light); font-size: 0.85rem;">
                        –°—É–º–º–∞ –∑–∞—Ç—Ä–∞—Ç –Ω–∞ –∑–∞–∫—É–ø–∫—É –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ √ó —Ü–µ–Ω–∞_–∑–∞–∫—É–ø–∫–∏.
                    </p>
                </div>
                <div>
                    <h4 style="color: var(--newyear-green); margin-bottom: 8px; font-size: 0.95rem;">üìà –ü—Ä–∏–±—ã–ª—å (Profit)</h4>
                    <p style="color: var(--light); font-size: 0.85rem;">
                        –ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å –æ—Ç –ø—Ä–æ–¥–∞–∂. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫: –í—ã—Ä—É—á–∫–∞ - –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å.
                    </p>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- FOOTER -->
<footer class="footer">
    <div class="container">
        <div class="footer-bottom">
            ¬© 2025 SuRam ¬∑ –° –Ω–æ–≤–æ–≥–æ–¥–Ω–∏–º –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ–º ¬∑ üéÑ
        </div>
    </div>
</footer>

<script src="{% static 'js/main.js' %}"></script>
</body>
</html>
