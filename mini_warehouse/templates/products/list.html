{% extends "base.html" %}

{% block content %}
    {% if messages %}
        <div class="card" style="margin-bottom: 20px;">
            {% for message in messages %}
                <div>{{ message }}</div>
            {% endfor %}
        </div>
    {% endif %}

    <div class="page-header">
        <h1><i class="fas fa-boxes"></i> Управление товарами</h1>
        <a href="{% url 'products:create' %}" class="btn btn-primary"><i class="fas fa-plus"></i> Добавить товар</a>
    </div>

    <div class="card">
        <div class="card-header">
            <h3>Список товаров</h3>
            <div class="search-box">
                <input type="text" placeholder="Поиск товаров..." class="form-control">
                <button class="btn btn-secondary"><i class="fas fa-search"></i></button>
            </div>
        </div>

        <div class="table-wrapper">
            <table class="table">
                <thead>
                    <tr>
                        <th>Название</th>
                        <th>Категория</th>
                        <th>Остаток</th>
                        <th>Цена</th>
                        <th>Статус</th>
                        <th>Действия</th>
                    </tr>
                </thead>
                <tbody>
                    {% for product in products %}
                        <tr>
                            <td>{{ product.name }}</td>
                            <td><span class="category-badge">Без категории</span></td>
                            <td>{{ product.stock }} шт.</td>
                            <td>₽ {{ product.sale_price|floatformat:2 }}</td>
                            <td>
                                {% if product.stock == 0 %}
                                    <span class="status status-out">Нет в наличии</span>
                                {% elif product.stock < 5 %}
                                    <span class="status status-low">Мало</span>
                                {% else %}
                                    <span class="status status-in-stock">В наличии</span>
                                {% endif %}
                            </td>
                            <td>
                                <a class="btn-icon" href="{% url 'products:edit' product.id %}"><i class="fas fa-edit"></i></a>
                                <form method="post" action="{% url 'products:delete' product.id %}" style="display:inline;">
                                    {% csrf_token %}
                                    <button type="submit" class="btn-icon"><i class="fas fa-trash"></i></button>
                                </form>
                            </td>
                        </tr>
                    {% empty %}
                        <tr>
                            <td colspan="6">Товары отсутствуют.</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="table-footer">
            <div class="pagination">
                <button class="btn btn-secondary"><i class="fas fa-chevron-left"></i></button>
                <span class="page-info">Страница 1 из 1</span>
                <button class="btn btn-secondary"><i class="fas fa-chevron-right"></i></button>
            </div>
            <div class="total-info">Всего товаров: {{ products|length }}</div>
        </div>
    </div>
{% endblock %}
