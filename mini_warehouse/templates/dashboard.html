{% extends "base.html" %}

{% block content %}

<!-- –ü–∞–Ω–µ–ª—å –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ (—Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
<div id="addProductPanel" class="add-product-panel">
    <div class="add-product-content">
        <div class="add-product-header">
            <h3><i class="fas fa-plus-circle"></i> –ë—ã—Å—Ç—Ä–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</h3>
            <button type="button" class="close-panel-btn">&times;</button>
        </div>

        <div class="add-product-form">
            <div class="form-row">
                <div class="form-group">
                    <label><i class="fas fa-tag"></i> –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</label>
                    <input type="text" id="productName" class="form-control">
                </div>

                <div class="form-group">
                    <label><i class="fas fa-tags"></i> –ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <select id="productCategory" class="form-control">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                        <option value="–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞">üì± –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞</option>
                        <option value="–ê—É–¥–∏–æ">üéß –ê—É–¥–∏–æ</option>
                        <option value="–ü—Ä–∞–∑–¥–Ω–∏–∫">üéÑ –ü—Ä–∞–∑–¥–Ω–∏–∫</option>
                        <option value="–ë—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞">üè† –ë—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞</option>
                        <option value="–ö–∞–Ω—Ü–µ–ª—è—Ä–∏—è">‚úèÔ∏è –ö–∞–Ω—Ü–µ–ª—è—Ä–∏—è</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label><i class="fas fa-box"></i> –ù–∞—á–∞–ª—å–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫</label>
                    <input type="number" id="productStock" min="0" value="10" class="form-control">
                </div>

                <div class="form-group">
                    <label><i class="fas fa-dollar-sign"></i> –¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏</label>
                    <input type="number" id="productPrice" min="0" value="1000" class="form-control">
                </div>
            </div>

            <div class="form-actions">
                <button type="button" class="btn btn-danger close-panel-btn">–û—Ç–º–µ–Ω–∞</button>
                <button type="button" class="btn btn-success" id="addProductBtn">
                    <i class="fas fa-check"></i> –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
                </button>
            </div>
        </div>
    </div>
</div>

<!-- –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ -->
<div class="metrics-grid">
    <div class="metric-card">
        <div class="metric-icon">üéÅ</div>
        <div class="metric-value" id="metricProductsCount">{{ products_count }}</div>
        <div class="metric-label">–¢–û–í–ê–†–û–í –í –°–ò–°–¢–ï–ú–ï</div>
    </div>

    <div class="metric-card">
        <div class="metric-icon">üí∞</div>
        <div class="metric-value" id="metricRevenueToday">‚ÇΩ {{ revenue_today|floatformat:0 }}</div>
        <div class="metric-label">–í–´–†–£–ß–ö–ê –°–ï–ì–û–î–ù–Ø</div>
    </div>

    <div class="metric-card">
        <div class="metric-icon">üìà</div>
        <div class="metric-value">{{ efficiency }}%</div>
        <div class="metric-label">–≠–§–§–ï–ö–¢–ò–í–ù–û–°–¢–¨</div>
    </div>

    <div class="metric-card">
        <div class="metric-icon">üõí</div>
        <div class="metric-value" id="metricSalesToday">{{ sales_today }}</div>
        <div class="metric-label">–ü–†–û–î–ê–ñ –ó–ê –î–ï–ù–¨</div>
    </div>
</div>

<!-- –¢–∞–±–ª–∏—Ü–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ -->
<div class="card">
    <div class="card-header">
        <h3><i class="fas fa-fire"></i> –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</h3>
        <div class="card-actions">
            <a href="{% url 'products:list' %}" class="btn btn-small btn-secondary">–í—Å–µ —Ç–æ–≤–∞—Ä—ã ‚Üí</a>
            <button class="btn btn-small btn-primary" id="openAddPanelBtn">
                <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
            </button>
        </div>
    </div>

    <div class="table-wrapper">
        <div class="table-container">
            <table class="table">
                <thead>
                <tr>
                    <th><i class="fas fa-cube"></i> –ù–∞–∑–≤–∞–Ω–∏–µ</th>
                    <th><i class="fas fa-tag"></i> –ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                    <th><i class="fas fa-box"></i> –û—Å—Ç–∞—Ç–æ–∫</th>
                    <th><i class="fas fa-tag"></i> –¶–µ–Ω–∞</th>
                    <th><i class="fas fa-circle"></i> –°—Ç–∞—Ç—É—Å</th>
                    <th><i class="fas fa-cog"></i> –î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
                </thead>

                <tbody id="popularProductsTbody">
                {% for p in popular_products %}
                    <tr data-product-id="{{ p.id }}">
                        <td>
                            <div class="product-info">
                                <div class="product-icon">üì¶</div>
                                <div>
                                    <div class="product-name">{{ p.name }}</div>
                                    <div class="product-sku">ID: {{ p.id }}</div>
                                </div>
                            </div>
                        </td>
                        <td><span class="category-badge">‚Äî</span></td>
                        <td><span class="stock-count">{{ p.stock }} —à—Ç.</span></td>
                        <td><span class="price">‚ÇΩ {{ p.sale_price|floatformat:0 }}</span></td>

                        {% if p.stock > 0 %}
                            <td><span class="status status-in-stock">–í –Ω–∞–ª–∏—á–∏–∏</span></td>
                        {% else %}
                            <td><span class="status status-out">–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏</span></td>
                        {% endif %}

                        <td>
                            <div class="action-buttons">
                                <a class="btn-icon btn-edit" href="{% url 'products:edit' p.id %}">
                                    <i class="fas fa-edit"></i>
                                </a>
                                <form action="{% url 'products:delete' p.id %}" method="post" style="display:inline;">
                                    {% csrf_token %}
                                    <button class="btn-icon btn-delete" type="submit">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </form>
                            </div>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>

            </table>
        </div>
    </div>
</div>

{% endblock %}
